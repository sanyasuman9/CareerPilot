<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Career Pilot - AI Chatbot</title>
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <style>
    body {
      margin: 0;
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(135deg, #3c6696, #10295f);
      color: #fff;
    }

    nav {
      display: flex;
      justify-content: space-between;
      align-items: center;
      width: 100%;
      box-sizing: border-box;
      background-color: rgba(15, 30, 63, 0.95);
      padding: 18px 50px;
      box-shadow: 0px 4px 8px rgba(0,0,0,0.2);
    }

    nav .brand a {
      text-decoration: none;
      color: inherit;
      display: flex;
      align-items: center;
      font-size: 1.8rem;
      font-weight: 700;
      font-family: 'Playfair Display', serif;
    }

    nav .brand i {
      color: #997953;
      margin-right: 10px;
      font-size: 1.6rem;
    }

    nav .center-links {
      flex-grow: 1;
      display: flex;
      justify-content: center;
      gap: 35px;
      list-style: none;
      margin: 0;
      padding: 0;
    }

    nav .center-links li {
      cursor: pointer;
      font-size: 1rem;
      font-weight: 500;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: color 0.3s;
      color: #fff;
    }

    nav .center-links li i { color: #CDAA80; }

    nav .center-links li.active {
      color: #CDAA80;
      font-weight: 700;
      font-size: 1.1rem;
      border-bottom: 3px solid #CDAA80;
      padding-bottom: 5px;
    }

    nav .center-links li:hover { color: #CDAA80; }

    nav .user-icon {
      width: 40px;
      height: 40px;
      background-color: #997953;
      border-radius: 50%;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 1.5rem;
      cursor: pointer;
    }

    .chat-container {
      max-width: 800px;
      margin: 50px auto;
      background-color: #213a56;
      border-radius: 15px;
      padding: 20px;
      display: flex;
      flex-direction: column;
      height: 70vh;
    }

    .chat-window {
      flex: 1;
      overflow-y: auto;
      padding: 10px;
      margin-bottom: 10px;
      border-radius: 10px;
      background-color: #0f1e3f;
    }

    .chat-message {
      margin: 10px 0;
      display: flex;
      align-items: flex-start;
      gap: 10px;
    }

    .chat-message.user { justify-content: flex-end; }

    .chat-message p {
      padding: 10px 15px;
      border-radius: 20px;
      max-width: 70%;
      margin: 0;
    }

    .chat-message.user p {
      background-color: #CDAA80;
      color: #0f1e3f;
    }

    .chat-message.bot p {
      background-color: #997953;
      color: #0f1e3f;
    }

    .input-area {
      display: flex;
      gap: 10px;
    }

    .input-area input {
      flex: 1;
      padding: 12px 15px;
      border-radius: 25px;
      border: none;
      font-size: 1rem;
    }

    .input-area button {
      padding: 12px 25px;
      background-color: #CDAA80;
      border: none;
      border-radius: 25px;
      color: #0F1E3F;
      font-weight: 600;
      cursor: pointer;
      transition: 0.3s;
    }

    .input-area button:hover {
      background-color: #997953;
      color: #fff;
    }
  </style>
</head>
<body>

<nav>
  <div class="brand">
    <a href="about.html"><i class="fas fa-compass"></i> Career Pilot</a>
  </div>
  <ul class="center-links">
    <li class="active"><i class="fas fa-robot"></i> AI Chatbot</li>
    <li onclick="window.location.href='roadmap.html'"><i class="fas fa-project-diagram"></i> Roadmaps</li>
    <li onclick="window.location.href='pagecourse.html'"><i class="fas fa-book-open"></i> Courses</li>
  </ul>
  <div class="user-icon"><i class="fas fa-user-circle"></i></div>
</nav>

<div class="chat-container">
  <div class="chat-window" id="chatWindow"></div>
  <div class="input-area">
    <input type="text" id="userInput" placeholder="Ask me about your career or skills..." />
    <button id="sendBtn">Send</button>
  </div>
</div>

<script>
const sendBtn = document.getElementById('sendBtn');
const userInput = document.getElementById('userInput');
const chatWindow = document.getElementById('chatWindow');

function appendMessage(message, sender) {
  const msgDiv = document.createElement('div');
  msgDiv.classList.add('chat-message', sender);
  const p = document.createElement('p');
  p.textContent = message;
  msgDiv.appendChild(p);
  chatWindow.appendChild(msgDiv);
  chatWindow.scrollTop = chatWindow.scrollHeight;
}

// ✅ Async bot response from Gemini API
async function botResponse(userMsg) {
  try {
    const response = await fetch('http://127.0.0.1:5000/career-predict', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({ user_input: userMsg })
    });

    const data = await response.json();
    return `A few roles you can look forward to are: ${data.prediction}`; // ✅ corrected key
  } catch (error) {
    console.error('Error fetching career prediction:', error);
    return "Sorry, I couldn't predict your role right now. Try again!";
  }
}


// Send button click handler
sendBtn.addEventListener('click', async () => {
  const msg = userInput.value.trim();
  if (!msg) return;

  appendMessage(msg, 'user');
  const reply = await botResponse(msg); // ✅ Await the async response
  appendMessage(reply, 'bot');

  userInput.value = '';
});

// Press Enter to send
userInput.addEventListener('keydown', (e) => {
  if (e.key === 'Enter') sendBtn.click();
});

// Initial bot message on page load
window.addEventListener('load', () => {
  appendMessage("I'm here to help you with career guidance! Tell me about your Skills, Interests or Role.", 'bot');
});
</script>

</body>
</html>
